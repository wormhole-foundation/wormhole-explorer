apiVersion: keda.sh/v1alpha1
kind: TriggerAuthentication
metadata:
  name: keda-auth-aws-{{ .NAME }}
  namespace: {{ .NAMESPACE }}
spec:
  podIdentity:
    provider: aws
---
apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: {{ .NAME }}
  namespace: {{ .NAMESPACE }}
spec:
  scaleTargetRef:
    name: {{ .NAME }}
  MIN_REPLICAS: {{ .MIN_REPLICAS }}
  MAX_REPLICAS: {{ .MAX_REPLICAS }}
  triggers:
  - type: aws-sqs-queue
    authenticationRef:
      name: keda-auth-aws-{{ .NAME }}
    metadata:
      awsRegion: {{ .SQS_AWS_REGION }}
      queueURL: {{ .PIPELINE_SQS_URL }}
      queueLength: {{ .MAX_QUEUE_LENGTH }}